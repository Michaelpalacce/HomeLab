---
apiVersion: helm.toolkit.fluxcd.io/v2beta1
kind: HelmRelease
metadata:
    name: botkube
    namespace: botkube
spec:
    interval: 5m
    install:
        createNamespace: true
        crds: CreateReplace
        remediation:
            retries: 3
    upgrade:
        crds: CreateReplace
        remediation:
            retries: 3
    chart:
        spec:
            chart: botkube
            version: v1.4.1
            interval: 5m
            sourceRef:
                kind: HelmRepository
                name: botkube
                namespace: flux-system
    values:
      image:
        tag: v1.1.1
      analytics:
        disable: true
      extraEnv:
        - name: BOTKUBE_COMMUNICATIONS_DEFAULT-GROUP_DISCORD_TOKEN
          valueFrom:
            secretKeyRef:
              name: token
              key: DISCORD_TOKEN
      communications:
        default-group:
          slack:
            enabled: false
          mattermost:
            enabled: false
          teams:
            enabled: false
          team:
            enabled: false
          elasticsearch:
            enabled: false
          webhook:
            enabled: false
          discord:
            enabled: true
            channels:
              default:
                id: "1008788276011880578"
            botID: "1008832691073974272"
      executors:
        "k8s-default-tools":
          botkube/kubectl:
            enabled: true
          botkube/helm:
            enabled: true
      settings:
        # -- Cluster name to differentiate incoming messages.
        clusterName: HomeLab

